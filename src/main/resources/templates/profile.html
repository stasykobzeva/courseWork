<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Profile</title>
    <link rel="stylesheet" th:href="@{/css/stylesMenu.css}" />
</head>

<header>
    <nav class="menu">
        <ul>
            <li>
                <a href="#">Главная</a>
                <ul>
                    <li><a th:href="@{/register}">Регистрация</a></li>
                    <li><a th:href="@{/login}">Вход</a></li>
                </ul>
            </li>
            <li>
                <a href="#">Играть</a>
                <ul>
                    <li><a href="#">Меню</a></li>
                    <li><a href="#">Справка</a></li>
                    <li><a href="#">Достижения</a></li>
                </ul>
            </li>
            <li>
                <a href="#">Контакты</a>
            </li>

            <li>
                <a href="/logout" class="logout-button">Выход</a>
            </li>
        </ul>

    </nav>
</header>

<body>
<h2 style="color: white;">Добро пожаловать, <span th:text="${user.name}">Пользователь</span></h2>

<!-- Отображение количества решённых задач -->
<p style="color: white;">Решённых задач: <span id="solved-tasks"></span></p>

<!-- Кнопка выхода -->

<!-- Внутри div со стилем display: grid -->
<!--<div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
    <div><a th:href="@{/task/1}">Задача 1</a></div>
    <div><a th:href="@{/task/2}">Задача 2</a></div>
    <div><a th:href="@{/task/3}">Задача 3</a></div>
    <div><a th:href="@{/task/4}">Задача 4</a></div>
    <div><a th:href="@{/task/5}">Задача 5</a></div>
    <div><a th:href="@{/task/6}">Задача 6</a></div>
    <div><a th:href="@{/task/7}">Задача 7</a></div>
    <div><a th:href="@{/task/8}">Задача 8</a></div>
    <div><a th:href="@{/task/9}">Задача 9</a></div>
    <div><a th:href="@{/task/10}">Задача 10</a></div>
    <div><a th:href="@{/task/11}">Задача 11</a></div>
    <div><a th:href="@{/task/12}">Задача 12</a></div>
</div> -->
<table class="buttons-table" style="width: 100%; border-collapse: collapse;">
    <tbody>
    <tr>
        <td><a th:href="@{/task/1}"><button>Уровень 1</button></a></td>
        <td><a th:href="@{/task/2}"><button>Уровень 2</button></a></td>
        <td><a th:href="@{/task/3}"><button>Уровень 3</button></a></td>
        <td><a th:href="@{/task/4}"><button>Уровень 4</button></a></td>
    </tr>
    <tr>
        <td><a th:href="@{/task/5}"><button>Уровень 5</button></a></td>
        <td><a th:href="@{/task/6}"><button>Уровень 6</button></a></td>
        <td><a th:href="@{/task/7}"><button>Уровень 7</button></a></td>
        <td><a th:href="@{/task/8}"><button>Уровень 8</button></a></td>
    </tr>
    <tr>
        <td><a th:href="@{/task/9}"><button>Уровень 9</button></a></td>
        <td><a th:href="@{/task/10}"><button>Уровень 10</button></a></td>
        <td><a th:href="@{/task/11}"><button>Уровень 11</button></a></td>
        <td><a th:href="@{/task/12}"><button>Уровень 12</button></a></td>
    </tr>
    </tbody>
</table>

<!-- <button onclick="logout()">Выход</button> -->

<!-- Форма входа -->
<!--<form id="loginForm">
    <input type="text" id="username" placeholder="Username" required>
    <input type="password" id="password" placeholder="Password" required>
    <button type="submit">Войти</button>
</form>
-->
<script>
    // Функция выхода
    function logout() {
        fetch('/logout')
            .then(() => {
                // Перенаправление на страницу входа
                window.location.href = "/login";
            });
    }

    // Обработка формы входа
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        fetch('/api/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ username: username, password: password })
        })
            .then(res => {
                if (res.ok) {
                    // Успех — перейти на профиль
                    window.location.href = "/profile";
                } else {
                    return res.text().then(text => alert('Ошибка: ' + text));
                }
            })
            .catch(error => {
                alert('Ошибка сети: ' + error);
            });
    });

    // Обновляем отображение решённых задач при загрузке
    document.addEventListener('DOMContentLoaded', () => {
        const solvedTasks = localStorage.getItem('solved_tasks') || '0';
        document.getElementById('solved-tasks').innerText = solvedTasks;
    });

    // Функция для обновления счётчика при решении задачи
    function updateSolvedCount(newCount) {
        document.getElementById('solved-tasks').innerText = newCount;
    }
</script>
</body>
</html>